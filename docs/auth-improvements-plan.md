# –ü–ª–∞–Ω —É–ª—É—á—à–µ–Ω–∏—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

## –¶–µ–ª–∏
1. –î–æ–±–∞–≤–∏—Ç—å –±–æ–ª—å—à–µ –º–µ—Ç–æ–¥–æ–≤ –≤—Ö–æ–¥–∞ (–Ω–µ —Ç–æ–ª—å–∫–æ magic link)
2. –¢—Ä–µ–±–æ–≤–∞—Ç—å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—é email + phone –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π

## –ú–µ—Ç–æ–¥—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏

### –¢–µ–∫—É—â–∏–µ
- ‚úÖ Email Magic Link (OTP)

### –î–æ–±–∞–≤–∏—Ç—å
- ‚è≥ Email + Password
- ‚è≥ Google OAuth
- ‚è≥ Facebook OAuth
- üí° GitHub OAuth (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- üí° Apple Sign In (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –¥–ª—è iOS)

## –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –¥–ª—è —Ä–∞–∑–º–µ—â–µ–Ω–∏—è –æ–±—ä—è–≤–ª–µ–Ω–∏–π

### –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è
1. **Email –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (`verified_email = true`)
2. **–¢–µ–ª–µ—Ñ–æ–Ω –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω** (`verified_phone = true`)

### –ü—Ä–æ—Ü–µ—Å—Å
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ
2. –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
3. –ï—Å–ª–∏ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–æ:
   - –ü–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
   - –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/verify`
   - –ü—Ä–µ–¥–ª–æ–∂–∏—Ç—å –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å email/—Ç–µ–ª–µ—Ñ–æ–Ω
4. –ü–æ—Å–ª–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è - —Ä–∞–∑—Ä–µ—à–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ –æ–±—ä—è–≤–ª–µ–Ω–∏—è

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –°—Ç—Ä–∞–Ω–∏—Ü—ã
- `/login` - –≤—Ö–æ–¥ (magic link, password, social)
- `/register` - —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (password, social)
- `/verify` - —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ email/phone

### Supabase Configuration

#### Email Provider
```toml
[auth.email]
enable_signup = true
double_confirm_changes = true
enable_confirmations = true
```

#### OAuth Providers (–≤ Dashboard)
- Google: —Ç—Ä–µ–±—É–µ—Ç—Å—è Client ID –∏ Secret
- Facebook: —Ç—Ä–µ–±—É–µ—Ç—Å—è App ID –∏ Secret

#### Password Policy
- –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
- –¢—Ä–µ–±–æ–≤–∞—Ç—å —Å–ø–µ—Ü—Å–∏–º–≤–æ–ª—ã (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### Database Changes

–¢–∞–±–ª–∏—Ü–∞ `profiles` —É–∂–µ –∏–º–µ–µ—Ç:
```sql
verified_email BOOLEAN DEFAULT false
verified_phone BOOLEAN DEFAULT false
```

### Middleware/Guards

–î–ª—è `/post` –º–∞—Ä—à—Ä—É—Ç–∞:
```typescript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä–µ–¥ —Å–æ–∑–¥–∞–Ω–∏–µ–º –æ–±—ä—è–≤–ª–µ–Ω–∏—è
const { verified_email, verified_phone } = profile;
if (!verified_email || !verified_phone) {
  redirect('/verify?reason=post_advert');
}
```

## –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

### –§–∞–∑–∞ 1 (–ö—Ä–∏—Ç–∏—á–Ω–æ)
1. ‚úÖ Email + Password login/register
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ –¥–ª—è /post
3. ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ /verify

### –§–∞–∑–∞ 2 (–í–∞–∂–Ω–æ)
1. ‚è≥ Google OAuth
2. ‚è≥ Facebook OAuth

### –§–∞–∑–∞ 3 (–ñ–µ–ª–∞—Ç–µ–ª—å–Ω–æ)
1. üí° GitHub OAuth
2. üí° Apple Sign In
3. üí° Phone OTP verification

## UX Flow

### –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
1. –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è (password –∏–ª–∏ social)
2. –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ email (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–∏—Å—å–º–æ)
3. –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–µ–ª–µ—Ñ–æ–Ω–∞ + –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
4. –¢–µ–ø–µ—Ä—å –º–æ–∂–µ—Ç —Ä–∞–∑–º–µ—â–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏—è

### –°—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
1. –í—Ö–æ–¥ (–ª—é–±—ã–º –º–µ—Ç–æ–¥–æ–º)
2. –ï—Å–ª–∏ –Ω–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω—ã email/phone:
   - –ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /verify
   - –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –Ω–µ–¥–æ—Å—Ç–∞—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ
3. –ü–æ—Å–ª–µ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ - –¥–æ—Å—Ç—É–ø –∫ —Ä–∞–∑–º–µ—â–µ–Ω–∏—é

## Security Considerations

1. **Rate Limiting**
   - –õ–∏–º–∏—Ç –Ω–∞ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞
   - –õ–∏–º–∏—Ç –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–æ–Ω–Ω—ã—Ö –∫–æ–¥–æ–≤

2. **Email Verification**
   - –¢–æ–∫–µ–Ω –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ 24 —á–∞—Å–∞
   - –ú–æ–∂–Ω–æ –∑–∞–ø—Ä–æ—Å–∏—Ç—å –ø–æ–≤—Ç–æ—Ä–Ω–æ

3. **Phone Verification**
   - SMS –∫–æ–¥ –∏—Å—Ç–µ–∫–∞–µ—Ç —á–µ—Ä–µ–∑ 10 –º–∏–Ω—É—Ç
   - –ú–∞–∫—Å–∏–º—É–º 3 –ø–æ–ø—ã—Ç–∫–∏

4. **Password Requirements**
   - –ú–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤
   - –ù–µ –∏–∑ —Å–ø–∏—Å–∫–∞ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π
   - –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–µ–Ω–µ–¥–∂–µ—Ä –ø–∞—Ä–æ–ª–µ–π

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

1. **2FA –¥–ª—è –≤—Å–µ—Ö –º–µ—Ç–æ–¥–æ–≤**
   - TOTP –¥–ª—è password-based
   - SMS –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

2. **–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏**
   - –ò–º–ø–æ—Ä—Ç –∞–≤–∞—Ç–∞—Ä–∞ –∏–∑ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π
   - –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å "–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω —á–µ—Ä–µ–∑ Google"

3. **Single Sign-On (SSO)**
   - –î–ª—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

## –ú–∏–≥—Ä–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å magic link:
- –ú–æ–≥—É—Ç –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å magic link
- –ú–æ–≥—É—Ç –¥–æ–±–∞–≤–∏—Ç—å –ø–∞—Ä–æ–ª—å –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö
- –ú–æ–≥—É—Ç –ø—Ä–∏–≤—è–∑–∞—Ç—å —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç-–∫–µ–π—Å—ã
- [ ] –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —Å –ø–∞—Ä–æ–ª–µ–º
- [ ] –í—Ö–æ–¥ —Å –ø–∞—Ä–æ–ª–µ–º
- [ ] –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Google
- [ ] –í—Ö–æ–¥ —á–µ—Ä–µ–∑ Facebook
- [ ] Magic link (backward compatibility)
- [ ] –ü–æ–ø—ã—Ç–∫–∞ —Å–æ–∑–¥–∞—Ç—å –æ–±—ä—è–≤–ª–µ–Ω–∏–µ –±–µ–∑ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏
- [ ] –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è email
- [ ] –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞
- [ ] –í—Å–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç –≤–º–µ—Å—Ç–µ

## –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

- Supabase Auth (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- Twilio –¥–ª—è SMS (—É–∂–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)
- Google OAuth credentials
- Facebook App credentials

