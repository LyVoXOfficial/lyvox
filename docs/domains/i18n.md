last_sync: 2025-10-28

# Internationalization & Locales (RFC)

## Overview
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å—Ç—Ä–∞–Ω –∏ —è–∑—ã–∫–æ–≤ (–ª–æ–∫–∞–ª–∏, –≤–∞–ª—é—Ç—ã, —Ñ–æ—Ä–º–∞—Ç—ã —Ç–µ–ª–µ—Ñ–æ–Ω–æ–≤).
- –¢—Ä–µ–±—É–µ—Ç—Å—è –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–æ—Å—Ç–∞ –º–∞—Ä–∫–µ—Ç–ø–ª–µ–π—Å–∞.

## Data Model (proposed)
- `public.locales` (`code`, `name`, `currency`, `date_format`, `phone_region`)
- `public.user_locales` (`user_id`, `locale_code`, `created_at`)
- –†–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ `adverts` –¥–ª—è –ª–æ–∫–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∞—Ç—Ä–∏–±—É—Ç–æ–≤ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏) ‚Äî –∏–ª–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ –Ω–µ–π—Ç—Ä–∞–ª—å–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ —Å —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ.

## App Architecture
- Next.js App Router –±–µ–∑ –ø—Ä–µ—Ñ–∏–∫—Å–æ–≤ –≤ URL; –≤—ã–±–æ—Ä —è–∑—ã–∫–∞ —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ cookie `locale`.
- Middleware `apps/web/middleware.ts` –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç `locale` –ø–æ query `?lang=` –ª–∏–±–æ `Accept-Language` (–ø–µ—Ä—Å–∏—Å—Ç–∏—Ç –≤ cookie).
- –°–ª–æ–≤–∞—Ä–∏ JSON: `apps/web/src/i18n/locales/{en,fr,nl,ru}.json`.
- –ü—Ä–æ–≤–∞–π–¥–µ—Ä: `apps/web/src/i18n/index.tsx` (–∫–æ–Ω—Ç–µ–∫—Å—Ç `useI18n` —Å `t(key)`), —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ —Ö–µ–ª–ø–µ—Ä—ã `apps/web/src/i18n/server.ts`.
- –í—Å—Ç—Ä–∞–∏–≤–∞–Ω–∏–µ: –≤ `app/layout.tsx` –ø–æ–¥–Ω–∏–º–∞–µ—Ç—Å—è `I18nProvider`, `html lang` = –∞–∫—Ç–∏–≤–Ω–∞—è –ª–æ–∫–∞–ª—å, meta –±–µ—Ä—É—Ç—Å—è –∏–∑ —Å–ª–æ–≤–∞—Ä—è.
- –§–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–∞—Ç/–≤–∞–ª—é—Ç: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ Intl API, –ª–æ–∫–∞–ª—å –±–µ—Ä—ë—Ç—Å—è –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞ (–¥–æ–±–∞–≤–∏—Ç—å —É—Ç–∏–ª–∏—Ç—ã –ø–æ –º–µ—Ä–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏).

## Supported Locales
- EN, NL, FR, RU, DE (fallback chain for missing keys: `de ‚Üí en ‚Üí ru`).

## Data normalization workflow (RU/EN mixed translation)
- –ò—Å—Ç–æ—á–Ω–∏–∫: –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ –º–æ–≥–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ä—É—Å—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è/–æ–ø–∏—Å–∞–Ω–∏—è –≤ `name_en`/`summary`.
- –°–∫—Ä–∏–ø—Ç `scripts/vehicle_i18n_normalize.mjs`:
  - –î–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –∫–∏—Ä–∏–ª–ª–∏—Ü—É –∏ —Å–º–µ—à–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å–∏.
  - –ü–µ—Ä–µ–≤–æ–¥–∏—Ç ru‚Üíen —á–µ—Ä–µ–∑ OpenAI (–ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è `OPENAI_MODEL`, –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é `gpt-4o-mini`; –¥–æ–ø—É—Å–∫–∞–µ—Ç—Å—è `gpt-5` –ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏).
  - –û–±–Ω–æ–≤–ª—è–µ—Ç –±–∞–∑–æ–≤—ã–µ `*_en`, –∞ –∏—Å—Ö–æ–¥–Ω—ã–π —Ä—É—Å—Å–∫–∏–π —Ç–µ–∫—Å—Ç —Å–∫–ª–∞–¥—ã–≤–∞–µ—Ç –≤ `vehicle_*_i18n(locale='ru')`.
  - –õ–æ–≥–∏ –ø—Ä–∞–≤–æ–∫ ‚Äî `logs/vehicle_i18n_autotranslate.csv`.
- –°–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å –∏–º—ë–Ω —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã—Ö (–º–∞—Ä–∫–∞/–º–æ–¥–µ–ª—å) –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç—Å—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–µ–π –¥–ª—è –º–æ–¥–µ–ª–∏ (–Ω–µ —Ç—Ä–∞–Ω—Å–ª–∏—Ç–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–∞–∑–≤–∞–Ω–∏—è: Passat –æ—Å—Ç–∞—ë—Ç—Å—è Passat).

## Deep Content Localization (inspection_tips, pros/cons, issues)
- –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è: `public.vehicle_generation_i18n` –¥–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–ª–æ–Ω–∫–∞–º–∏:
  - `pros text[]`, `cons text[]`, `inspection_tips text[]`, `common_issues text[]`, –∞ —Ç–∞–∫–∂–µ `summary text` (—É–∂–µ –±—ã–ª–∞).
- –ö–∞–∫ –ø–æ–ø–æ–ª–Ω—è–µ—Ç—Å—è: —Å–∫—Ä–∏–ø—Ç `scripts/vehicle_i18n_expand.mjs`
  - –ò—Å—Ç–æ—á–Ω–∏–∫: –±–∞–∑–æ–≤—ã–µ –ø–æ–ª—è –ø–æ–∫–æ–ª–µ–Ω–∏—è/–º–æ–¥–µ–ª–∏ (`vehicle_generations.summary`, `vehicle_insights.pros/cons/inspection_tips/common_issues_by_engine`).
  - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —è–∑—ã–∫–∞: RU vs EN –ø–æ –Ω–∞–ª–∏—á–∏—é –∫–∏—Ä–∏–ª–ª–∏—Ü—ã.
  - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è: –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–æ–ª—è —Å–æ–∑–¥–∞—é—Ç—Å—è –≤–∞—Ä–∏–∞–Ω—Ç—ã –¥–ª—è `en, ru, nl, fr, de` —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º —Ç–µ—Ö. —Ç–æ–∫–µ–Ω–æ–≤ (BMW/TDI/DSG/DPF –∏ –¥—Ä.).
  - –ó–∞–ø–∏—Å—å: upsert c merge-–ª–æ–≥–∏–∫–æ–π ‚Äî –Ω–µ –∑–∞—Ç–∏—Ä–∞–µ—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–≤–æ–¥—ã; –∑–∞–ø–æ–ª–Ω—è–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–æ–ø—É—Å–∫–∏.
  - DRY_RUN: –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è; –∞—É–¥–∏—Ç ‚Äî `logs/vehicle_i18n_expand.csv` (generation_id, field_name, locale_written, original_snippet, translated_snippet).
- Fallback –ø–æ—Ä—è–¥–æ–∫ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏: `–∑–∞–ø—Ä–æ—à–µ–Ω–Ω–∞—è –ª–æ–∫–∞–ª—å ‚Üí en ‚Üí ru`.
- –ó–∞—á–µ–º —ç—Ç–æ –≤–∞–∂–Ω–æ: –±–æ–≥–∞—Ç—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è –ø–æ–≤—ã—à–∞—é—Ç SEO (rich snippets) –∏ —Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–æ–≤ AI‚Äë–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–≤ –≤ —Å—Ü–µ–Ω–∞—Ä–∏—è—Ö –≤—Ä–æ–¥–µ ‚Äú–Ω–∞–π–¥–∏ –¥–∏–∑–µ–ª—å –¥–æ 5000 –µ–≤—Ä–æ —Å –∞–≤—Ç–æ–º–∞—Ç–æ–º‚Äù.

## Integrations & Dependencies
- SEO –∏ –∫–∞–Ω–æ–Ω–∏—á–µ—Å–∫–∏–µ —Å—Å—ã–ª–∫–∏ –ø–æ –ª–æ–∫–∞–ª—è–º.
- –õ–æ–∫–∞–ª–∏–∑–∞—Ü–∏—è email/push —à–∞–±–ª–æ–Ω–æ–≤.

## Improvements & TODO Links
- TODO.md: –≤–∫–ª—é—á–∏—Ç—å i18n RFC, —Å–ø–∏—Å–æ–∫ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö –ª–æ–∫–∞–ª–µ–π, —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —à–∞–≥–∏ –ø–æ –ø–µ—Ä–µ—Ö–æ–¥—É.
- PLAN.md: Multi-tenant/Locale Expansion ‚Äî –≤—ã–¥–µ–ª–∏—Ç—å –¥–æ—Ä–æ–∂–Ω—É—é –≤–µ—Ö—É.

## Change Log
- 2025-10-28: Initial i18n RFC.


- Database i18n tables for vehicles: `vehicle_make_i18n`, `vehicle_model_i18n`, `vehicle_generation_i18n` (read-only RLS); helper SQL functions `vehicle_makes_localized(locale)`, `vehicle_models_localized(locale, make_id)`, `vehicle_generations_localized(locale, model_id)`.
- UI dictionaries handle low-cardinality enums (body/fuel/transmission) via codes; DB stores canonical codes/EN where applicable.

---

## üîó Related Docs

**Development:** [MASTER_CHECKLIST.md](../development/MASTER_CHECKLIST.md)
**Catalog:** [CATALOG_IMPLEMENTATION_STATUS.md](../catalog/CATALOG_IMPLEMENTATION_STATUS.md) ‚Ä¢ [CATALOG_MASTER.md](../catalog/CATALOG_MASTER.md) ‚Ä¢ [FINAL_COMPLETION_REPORT.md](../catalog/FINAL_COMPLETION_REPORT.md) ‚Ä¢ [IMPLEMENTATION_SUMMARY.md](../catalog/IMPLEMENTATION_SUMMARY.md)
